var Ak_Framework=function(l){"use strict";return{$document:l(document),_doingAjax:!1,_currentAjax:!1,termInitialized:!1,init:function(){this.setup_fields(),this.handle_notices(),l('[data-toggle="tooltip"]').tooltip()},_ajax:function(r,e,t,i){var a=this,o=(a._doingAjax=!0,l.extend({action:"ak_ajax",nonce:ak_framework_loc.nonce,panelID:l("#ak-panel-id").val(),lang:ak_framework_loc.lang},e));return l.ajax({url:ajaxurl,type:"POST",dataType:"json",data:o}).done(function(e){var t,n;e.result&&e.result.is_error&&(e.result.error_message+="\n\n",e.result.error_message+=JSON.stringify(o),console.error(e.result.error_message,e.result.error_code),(n=(t=a._show_error(e.result.error_message,e.result.error_code)).$modal.find(".ak-pages-error-section textarea")).height(n[0].scrollHeight),t.make_vertical_center(),e.status="error"),a._doingAjax=!1,r.apply(this,arguments)}).fail(function(e,t,n){a._show_error(n,t),i&&i.call(this,arguments)})},_show_error:function(e,t){var n=jQuery.extend({},ak_framework_loc.on_error);e&&t&&(n.body='<textarea class="error-textarea">'+t+" - "+e+"</textarea>"),swal({title:n,text:n.body,type:"warning",confirmButtonText:n.button_ok,closeOnConfirm:!0,showConfirmButton:!1,showCancelButton:!0,html:!0}),this._error_copy()},_error_copy:function(){l(document).on("click",".ak-pages-error-copy",function(e){e.preventDefault();var t,n=l(this);l(".ak-pages-error-section textarea").trigger("focus").trigger("select"),document.execCommand("copy")&&(t=n.html(),n.html(n.data("copied")),n.delay(750).queue(function(e){n.html(t),e()}))})},handle_notices:function(){l(".ak-notice").on("click",".notice-dismiss",function(){var e=l(this).parent();e.slideUp(300),setTimeout(function(){e.remove()},300),l.ajax({url:ajaxurl,type:"post",data:{action:"ak_dismiss_notice",nonce:ak_framework_loc.nonce,id:e.attr("id")}})})},setup_fields:function(e){l(document).on("change",'input[name="mailchimp_url"]',function(){var e=l(this).val().match(/action="([^"]*?)"/i);null!=e&&void 0!==e[1]&&l(this).val(e[1])})},reload_location:function(e){this.turn_refresh_notice_off(),e?setTimeout(function(){location.reload()},e):location.reload()}}}(jQuery);function ak_update_query_string(e,t,n){n=n||window.location.href;var r,i=new RegExp("([?|&])"+e+"=.*?(&|#|$)(.*)","gi");return i.test(n)?null!=t?n.replace(i,"$1"+e+"="+t+"$2$3"):(n=(r=n.split("#"))[0].replace(i,"$1$3").replace(/(&|\?)$/,""),void 0!==r[1]&&null!==r[1]&&(n+="#"+r[1]),n):(null!=t&&(i=-1!==n.indexOf("?")?"&":"?",n=(r=n.split("#"))[0]+i+e+"="+t,void 0!==r[1]&&null!==r[1]&&(n+="#"+r[1])),n)}function ak_in_array(e,t){for(var n=t.length,r=0;r<n;r++)if(t[r]===e)return!0;return!1}function ak_find_key_value_in_array(t,n){var r;return Object.keys(n).some(function(e){return e===t?(r=n[e],!0):n[e]&&"object"==typeof n[e]?void 0!==(r=ak_find_key_value_in_array(t,n[e])):void 0}),r}function ak_remove_from_array(e){for(var t,n,r=arguments,i=r.length;1<i&&e.length;)for(t=r[--i];-1!==(n=e.indexOf(t));)e.splice(n,1);return e}function ak_array_unique(e){var t,n="",r=[];for(n in e)e.hasOwnProperty(n)&&!1===function(e,t){var n="";for(n in t)if(t.hasOwnProperty(n)&&t[n]+""==e+"")return n;return!1}(t=e[n],r)&&(r[n]=t);return r}function ak_value_compare_in(e,t){var n=!1,r=null,i=null;return"object"==typeof e&&"object"!=typeof t?(r=e,i=t):"object"==typeof t&&"object"!=typeof e&&(r=t,i=e),r&&i?ak_in_array(i,r)&&(n=!0):n="string"==typeof e&&"string"==typeof t&&-1<t.indexOf(e)||e==t,n}function ak_value_compare(e,t,n){return"==="===n?e===t:"="===n||"=="===n||"equals"===n||"equal"===n?e==t:"!=="===n?e!==t:"!="===n||"not equal"===n?e!=t:">="===n||"greater or equal"===n||"equal or greater"===n?t<=e:"<="===n||"smaller or equal"===n||"equal or smaller"===n?e<=t:">"===n||"greater"===n?t<e:"<"===n||"smaller"===n?e<t:"in"===n||"contains"===n?ak_value_compare_in(e,t):"not_in"===n||"not_contains"===n?!ak_value_compare_in(e,t):void 0}function ak_debounce(r,i,a){var o;return function(){var e=this,t=arguments,n=a&&!o;clearTimeout(o),o=setTimeout(function(){o=null,a||r.apply(e,t)},i),n&&r.apply(e,t)}}function ak_is_value_true(e){return 1===e||"1"===e||!0===e||"true"===e||"on"===e}function ak_is_value_false(e){return 0===e||"0"===e||!1===e||"false"===e||"off"===e}function ak_sanitize_protocol(e){return ak_is_value_true(ak_framework_loc.is_ssl)?e.replace("http://","https://"):e.replace("http://","//")}Ak_Framework.init(),function(l){"use strict";l.fn.ak_serialize=function(r,i){var a,o={};if(l(this).find(":input").each(function(){var e,t=l(this);if((n=t.attr("name"))&&!this.disabled){t.attr("type");var n=i?(e=(e=n.replace(i,"")).split("["),""===(e=l.map(e,function(e){return e.replace(/\]/g,"")}))[0]&&e.shift(),e):n,n=r?n:encodeURIComponent(n);if(t.is(":radio,:checkbox"))a=this.checked?this.value:"";else{if(t.is("select[multiple]"))return o[n]=[],t.find("option:selected").each(function(e){var t=l(this),t=r?t.val():encodeURIComponent(t.val());o[n][t]=t}),0;a=this.value}void 0!==o[n]&&!a||(o[n]=r?a:encodeURIComponent(a))}}),r)return o;var e,t="";for(e in o)if(Array.isArray(o[e]))for(var n in o[e])t+=e+"[]="+o[e][n]+"&";else t+=e+"="+o[e]+"&";return t},l.ak_unserialize=function(e){for(var t,n,r,i=decodeURI(e).split("&"),a={},o=0,l=i.length;o<l;o++)(r=(n=i[o].split("="))[0]).indexOf("[]")==r.length-2?(void 0===a[t=r.substring(0,r.length-2)]&&(a[t]=[]),a[t].push(n[1])):a[r]=n[1];return a}}(jQuery),function(a){"use strict";a.fn.ak_redirect=function(e,t,n){void 0!==n?"GET"!=(n=n.toUpperCase())&&(n="POST"):n="POST",void 0!==t&&0!=t||(e=(t=a().ak_parse_url(e)).url,t=t.params);var r,i=a("<form></form");for(r in i.attr("method",n),i.attr("action",e),t)e=a("<input />"),e.attr("type","hidden"),e.attr("name",r),e.attr("value",t[r]),e.appendTo(i);a("body").append(i),i.submit()},a.fn.ak_parse_url=function(e){if(-1==e.indexOf("?"))return{url:e,params:{}};var t,n=e.split("?"),e=n[0],r={},i={};for(t in n=n[1].split("&")){var a=n[t].split("=");i[a[0]]=a[1]}return r.url=e,r.params=i,r}}(jQuery);var FormDataJson=function(){function h(){}return h.toJson=function(e,v){v=h.merge(h.defaultOptionsToJson,v);var e=h.getFieldTree(e,function(e){if("function"==typeof v.inputFilter&&!0!==v.inputFilter(e))return!1;if(!v.includeDisabled&&e.disabled)return!1;var t=(e.type||"text").toLowerCase();return!(!v.includeButtonValues&&(e instanceof HTMLButtonElement||-1<h.buttonInputTypes.indexOf(t)))&&!(void 0===v.uncheckedValue&&-1<h.checkedInputTypes.indexOf(t)&&!e.checked)}),t=v.flatList?[]:{},y=[];function i(){return v.arrayify&&(t=function e(t){if(h.isObject(t)){var n,r=0,i=!0;for(n in t)!h.isObject(t[n])||t[n]instanceof Element||(t[n]=e(t[n])),parseInt(n)!==r&&(i=!1),r++;if(i){var a,o=[];for(a in t)o.push(t[a]);return o}}return t}(t)),t=v.skipEmpty?function e(t,n){var r=h.isArray(t);var i=r?[]:{};var a=0;for(var o in t){var l=t[o];v.flatList&&!n&&(l=l[1]),"object"!=typeof(l=h.isObject(l)||h.isArray(l)?e(l,(n||0)+1)||"":l)&&""===h.stringify(l)||(r?i.push(t[o]):i[o]=l,a++)}return a?i:null}(t)||(v.flatList?[]:{}):t}if(!function e(c,t){for(var n in c){var r=c[n],f=v.flatList?r.name:n;if("nested"!==r.type){var i=r.input,p=r.inputType;if("file"!==p){var a=null;if("radio"===r.type){for(var o=0;o<r.inputs.length;o++){var d=r.inputs[o];if(d.checked){a=d.value;break}}null===a&&(a=v.uncheckedValue)}else if("checkbox"===p)a=i.checked?i.value:v.uncheckedValue;else if(i instanceof HTMLSelectElement){for(var l=[],u=0;u<i.options.length;u++){var s=i.options[u];s.selected&&l.push((void 0!==s.value?s.value:s.text).toString())}a=i.multiple?l:l.length?l[0]:null}else a=i.value;v.flatList?t.push([r.name,a]):t[f]=a}else v.filesCallback&&y.push({object:t,key:f,input:i})}else v.flatList?e(r.tree,t):(t[n]={},e(r.tree,t[n]))}}(e,t),y.length){function n(e){for(var n=y[e],r=n.object,t=(o+=n.input.files.length,0);t<n.input.files.length;t++)!function(e){var e=n.input.files[e],t=new FileReader;t.onload=function(){n.input.multiple?(h.isArray(r[n.key])||(r[n.key]=[]),r[n.key].push(t.result)):r[n.key]=t.result,++a===o&&v.filesCallback(i())},t[v.fileReaderFunction](e)}(t)}for(var a=0,o=0,r=0;r<y.length;r++)n(r)}else if(v.filesCallback)return v.filesCallback(i()),null;return i()},h.fromJson=function(e,t,l,n){var r,u;(h.isObject(t)||h.isArray(t))&&(l=h.merge(h.defaultOptionsFromJson,l),r=h.getFieldTree(e),u={},l.clearOthers&&h.clear(e),l.resetOthers&&h.reset(e),function e(t,n){if(h.isObject(n)||h.isArray(n))for(var r in t){var i=t[r],r=l.flatList?i.name:r;if("nested"!==i.type)if(l.flatList)for(var a in n){var o=n[a];if(o&&o[0]===i.name&&u[i.name]!==a){u[i.name]=a,h.setInputValue(i,o[1],l.triggerChangeEvent);break}}else void 0!==n[r]&&h.setInputValue(i,n[r]||null,l.triggerChangeEvent);else l.flatList?e(i.tree,n):"object"==typeof n[r]&&e(i.tree,n[r])}}(r=void 0!==n?r[n]:r,t))},h.reset=function(e){!function e(t){for(var n in t){var r=t[n];if("nested"!==r.type)if("radio"!==r.type){if(!(r.inputType&&-1<h.buttonInputTypes.indexOf(r.inputType)))if(n=r.input,-1<h.checkedInputTypes.indexOf(r.inputType))n.checked=n.defaultChecked;else if(n instanceof HTMLSelectElement)for(var i=n.querySelectorAll("option"),a=0;a<i.length;a++){var o=i[a];o.selected=o.defaultSelected}else n.getAttribute("value")?n.value=n.getAttribute("value"):"string"!=typeof n.defaultValue&&"number"!=typeof n.defaultValue||(n.value=n.defaultValue)}else for(var l=0;l<r.inputs.length;l++){var u=r.inputs[l];u.checked=u.defaultChecked}else e(r.tree)}}(h.getFieldTree(e))},h.clear=function(e){!function e(t){for(var n in t)"nested"!==(n=t[n]).type?n.input&&-1<h.buttonInputTypes.indexOf(n.inputType)||h.setInputValue(n,null):e(n.tree)}(h.getFieldTree(e))},h.setInputValue=function(e,t,n){var r=n?function(e){var t=null;"function"==typeof Event?t=new Event("change",{bubbles:!0}):(t=document.createEvent("Event")).initEvent("change",!0,!0),e.dispatchEvent(t)}:null;if("radio"!==e.type){var i=e.input,n=e.inputType;if("file"!==n){var a=!1;if("checkbox"===n)(t=!0===t||null!==t&&h.stringify(i.value)===h.stringify(t))!==i.checked&&(a=!0),i.checked=t;else if(i instanceof HTMLSelectElement){var o=t;null==o?o=[]:h.isObject(o)?o=Object.values(o):h.isArray(o)||(o=[o]);for(var c=0;c<i.options.length;c++){var l=i.options[c],f=(void 0!==l.value?l.value:l.text).toString();!1!==l.selected&&(a=!0),l.selected=!1;for(var p=0;p<o.length;p++)if(f===h.stringify(o[p])){!0!==l.selected&&(a=!0),l.selected=!0;break}}}else i.value!==t&&(a=!0),i.value=t;a&&r&&r(i)}}else{for(var u=[],d=0;d<e.inputs.length;d++){var s=e.inputs[d];if(s.checked&&u.push(s),s.checked=!1,null!==t&&h.stringify(s.value)===h.stringify(t)){s.checked||u.push(s),s.checked=!0;break}}if(r)for(var v in u)r(u[v])}},h.stringify=function(e){return void 0===e||"object"==typeof e?"":"boolean"==typeof e?e?"1":"0":e+""},h.getFieldTree=function(e,c){if(!(e=h.getElement(e)))return[];for(var f=e.querySelectorAll("select, textarea, input, button"),p={},t={},n=0;n<f.length;n++){var r=f[n];if(r.name&&0!==r.name.length&&(!c||!0===c(r)))for(var i=(r.type||"text").toLowerCase(),d=r.name,v=r.name.replace(/\]/g,"").split("["),y=("[]"===d.substr(-2)&&(r instanceof HTMLSelectElement&&r.multiple||"radio"===i)&&v.pop(),v.length),a=p,o="",l=0;l<y;l++){var u=v[l],s=o?o+"["+u+"]":u;""===u&&(void 0===t[s]&&(t[s]=0),u=t[s].toString(),t[s]++),o=o?o+"["+u+"]":u,y-1===l?"radio"===(r.type||"text").toLowerCase()?(void 0===a[u]&&(a[u]={type:"radio",name:r.name,inputType:i,inputs:[]}),a[u].inputs.push(r)):a[u]={type:"default",name:r.name,inputType:i,input:r}:(void 0!==a[u]&&void 0!==a[u].tree||(a[u]={type:"nested",tree:{}}),a=a[u].tree)}}return p},h.isObject=function(e){return e&&"object"==typeof e&&"[object Array]"!==Object.prototype.toString.call(e)},h.isArray=function(e){return"object"==typeof e&&"[object Array]"===Object.prototype.toString.call(e)},h.getElement=function(e){return"string"==typeof e?document.querySelector(e):e instanceof HTMLElement?e:"undefined"!=typeof jQuery&&e instanceof jQuery?e[0]:(console.warn("FormDataJson: Unsupported element passed. Supported is HTMLElement, a string query selector or JQuery object"),null)},h.merge=function(e,t){var n,r,i={};for(n in e)i[n]=e[n];for(r in t)i[r]=t[r];return i},h}();FormDataJson.defaultOptionsToJson={includeDisabled:!1,includeButtonValues:!1,uncheckedValue:void 0,inputFilter:null,flatList:!1,skipEmpty:!1,filesCallback:null,fileReaderFunction:"readAsDataURL",arrayify:!0},FormDataJson.defaultOptionsFromJson={flatList:!1,clearOthers:!1,resetOthers:!1,triggerChangeEvent:!1},FormDataJson.buttonInputTypes=["button","submit","reset","image"],FormDataJson.checkedInputTypes=["checkbox","radio"];