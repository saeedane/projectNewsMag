!function(a){"use strict";({$document:a(document),init:function(){var n=this;n.$document.on("ready",function(){n.save_panel(),n.reset_panel(),n.import_export_panel(),n.panel_sticky_buttons(),n.handle_changed_options()})},save_panel:function(){var o=this;o.$document.on("click",".ak-save-button",function(n){n.preventDefault(),swal({title:"Saving Changes...",text:'<div id="purchase_loading"><i class="fa fa-refresh fa-spin fa-3x fa-fw"></i></div>',html:!0,timer:2e7,showConfirmButton:!1}),o.ajax({page_action:"save_options",data:o._get_panel_data()},function(n){n&&void 0!==n.success&&n.success?o.show_response("success"):o.show_response("error"),void 0!==n.result.refresh&&n.result.refresh&&o.reload_location(1500)})})},reset_panel:function(){var o=this;o.$document.on("click",".ak-reset-button",function(n){n.preventDefault(),swal({title:a(".ak-reset-button").data("confirm"),type:"warning",confirmButtonText:"Reset",showCancelButton:!0},function(n){if(n)return o.ajax({page_action:"reset_options"},function(n){n&&void 0!==n.success&&n.success?o.show_response("success"):o.show_response("error"),void 0!==n.result.refresh&&n.result.refresh&&o.reload_location(1500)}),!0})})},import_export_panel:function(){var e,t=this;t.$document.on("click",".ak_download_export",function(){var n=ak_framework_loc.ajax_url,o=a(this).data("file-name"),e=a(this).data("option-id");return a().ak_redirect(n,{action:"ak_admin_ajax",action_id:"product-panel",module_id:"option-panel",page_action:"export",nonce:ak_framework_loc.nonce,lang:ak_framework_loc.lang,file_name:o,option_id:e}),!1}),a(".ak-import-file-input").fileupload({limitMultiFileUploads:1,url:ak_framework_loc.ajax_url,autoUpload:!1,replaceFileInput:!1,formData:{nonce:ak_framework_loc.nonce,lang:ak_framework_loc.lang,action:"ak_admin_ajax",action_id:"product-panel",module_id:"option-panel",page_action:"import",option_id:a("#ak-panel-id").val()},add:function(n,o){e=function(){return o.submit()}},start:function(n){console.log("loading")},done:function(n,o){o=o.result;o&&void 0!==o.success&&o.success?t.show_response("success"):t.show_response("error"),void 0!==o.result.refresh&&o.result.refresh&&t.reload_location(1500)},error:function(n,o,e){t.show_response("error")},progressall:function(n,o){parseInt(o.loaded/o.total*100,10)},drop:function(n,o){return!1}}),a(".ak-import-file-input").on("change",function(){return void 0!==e&&swal({title:a(".ak_import_button ").data("confirm"),type:"info",confirmButtonText:"Import",showCancelButton:!0},function(n){if(n)return e(),!0}),!1})},panel_sticky_buttons:function(){function n(){var n=o.innerWidth();a(document).innerHeight()-a(window).height()-a(document).scrollTop()<=75?o.removeClass("sticky"):o.addClass("sticky"),a(".ak-panel-save-sticky").css("width",n+"px")}var o=a(".ak-panel-save-container");setInterval(function(){n()},500),a(window).scroll(function(){n()})},handle_changed_options:function(){var o=this,e=o._get_panel_data();a(".ak-form-field-main-input").change(function(n){n.preventDefault();n=e!==o._get_panel_data();a(".ak-save-button")[n?"addClass":"removeClass"]("ak-option-changed")})},_get_panel_data:function(){return a("#ak_panel_form").ak_serialize()},ajax:function(n,o){var e=this;a.ajax({url:ak_framework_loc.ajax_url,type:"POST",dataType:"json",data:a.extend({action:"ak_admin_ajax",action_id:"product-panel",module_id:"option-panel",option_id:a("#ak-panel-id").val(),nonce:ak_framework_loc.nonce,lang:ak_framework_loc.lang},n)}).done(o).fail(function(){e.show_response("error")})},show_response:function(n){var o=ak_option_panel_loc[n];swal({title:o.title,text:o.text,type:n,confirmButtonText:o.confirmButtonText,closeOnConfirm:!0,showConfirmButton:!1,showCancelButton:!1,html:!0,timer:1500})},reload_location:function(n){this.turn_refresh_notice_off(),n?setTimeout(function(){location.reload()},n):location.reload()}}).init()}(jQuery);