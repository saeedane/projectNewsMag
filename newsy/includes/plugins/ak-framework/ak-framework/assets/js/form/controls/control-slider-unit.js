!function(n){"use strict";ak.form.controlConstructor.slider_unit=ak.form.Control.extend({valid_units:["rem","em","ex","%","px","cm","mm","in","pt","pc","ch","vh","vw","vmin","vmax"],current_unit:null,default_unit:"px",spinner_el:void 0,slider_input_el:void 0,unit_input_el:void 0,input_el:void 0,choices_el:void 0,min:0,max:100,step:1,ready:function(){this.spinner_el=this.container.find(".ak-slider-spinner"),this.slider_input_el=this.container.find(".ak-slider-unit-input"),this.unit_input_el=this.container.find(".ak-unit-input-unit"),this.input_el=this.container.find(".ak-form-field-main-input"),this.choices_el=this.container.find(".ak-unit-input-choices");var i=this.unit_input_el.text(),i=(0<i.legnth&&ak_in_array(i,this.valid_units)&&(this.default_unit=i),this.input_el.data("min")&&(this._min=Number(this.input_el.data("min"))),this.input_el.data("max")&&(this._max=Number(this.input_el.data("max"))),this.input_el.data("step")&&(this._step=Number(this.input_el.data("step"))),this.input_el.val()),t=this.getValueNumber(i),e=(this.slider_input_el.val(t),this.spinner_el.slider({value:""!=i?t:this._min,step:this._step,min:this._min,max:this._max,range:"min",slide:ak_debounce(function(i,t){e.setValue(t.value)},10)}),this.slider_input_el.on("keyup paste",ak_debounce(function(){e.setValue(n(this).val())},500)),this);this.unit_input_el.on("click",function(i){i.preventDefault(),e.choices_el.toggleClass("ak-active")}),this.choices_el.on("click","> li",function(){e.choices_el.removeClass("ak-active");var i=e.slider_input_el.val(),t=n(this).data("unit");e.current_unit=t,e.setValue(i+t)})},setValue:function(i){var t=this,e=t.getValueNumber(i),n=t.getValueUnit(i);t.choices_el.find("> li").removeClass("ak-active"),t.choices_el.find('li[data-unit="'+n+'"]').addClass("ak-active"),t.unit_input_el.text(n),""!=i?(!1===t.validateUnitFromValue(e+n)?t.slider_input_el.addClass("ak-invalid-value"):(t.slider_input_el.removeClass("ak-invalid-value"),i=e+n),t.slider_input_el.val(e),t.spinner_el.slider("value",e)):(t.input_el.val(i=""),t.slider_input_el.val(""),t.spinner_el.slider("value","")),t.input_el.val(i).trigger("input"),t.setting.set(i)},getValueNumber:function(i){i=parseFloat(i);return i=isNaN(i)?"":i},getValueUnit:function(i){var t=this,i=t.getUnitFromValue(i);return"string"==typeof(i=!1===i?t.current_unit:i)?i:t.default_unit},getUnitFromValue:function(i){var t;return""!==i&&!jQuery.isNumeric(i)&&(t=parseFloat(i),!!jQuery.isNumeric(t)&&(i=i.replace(t,""),!!ak_in_array(i,this.valid_units)&&i))},validateUnitFromValue:function(i){var t;return!("0"!==i&&""!==i&&!jQuery.isNumeric(i))||(0<=i.indexOf("calc(")&&0<=i.indexOf(")")||(t=parseFloat(i),i=i.replace(t,""),!isNaN(t)&&!!ak_in_array(i,this.valid_units)))}})}(jQuery);