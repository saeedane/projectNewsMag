!function(c){"use strict";ak.form.controlConstructor.icon_select=ak.form.Control.extend({but_el:!1,$instance_response:void 0,search_array:[],$icon_element_cache:[],ready:function(){var n=this,a=n.container.find(".ak-icon-select-manager");n.but_el=a,c(a).on("click",function(a){a.preventDefault(),swal({title:ak_icon_manager_loc.title,text:n.get_icon_elements(),customClass:"font_popup",confirmButtonColor:"#DD6B55",showConfirmButton:!1,showCancelButton:!0,allowOutsideClick:!0,html:!0})})},setValue:function(a){var n=this,e=n.container.find(".ak-icon-select-manager"),i=n.container.find("input");a&&""!=a&&null!=a?(e.find(".ak-icon-selected-name").html(n.get_icon_tag(a)+" "+a),i.val(a).trigger("change"),n.setting.set(a)):(e.find(".ak-icon-selected-name").html("-"),i.val("").trigger("change"),n.setting.set(""))},get_icon_elements:function(){var a="",a='<div class="ak-icon-select-icons">';return a=(a=(a=(a=(a=(a=(a+='<button class="cancel modal-close" tabindex="2"><i class="fa fa-window-close"></i></button>')+('<input type="text" class="search-icons form-control" tabindex="3"  placeholder="'+ak_icon_manager_loc.search_icon+'">')+'<ul class="icon-search-wrap options-list ak-clearfix"></ul>')+'<div class="ak-icon-wrap ak-clearfix">'+'<div class="ak-icon-actions ak-clearfix">')+('<button data-value="" class="cancel ak-icon-select-button ak-no-icon-button"><i class="fa fa-times"></i> '+ak_icon_manager_loc.remove_icon+"</button>"))+('<button class="confirm ak-custom-icon-select">'+ak_icon_manager_loc.custom_icon_select+"</button>"))+"</div>"+'<div class="ak-icon-load"></div>')+"</div>"+"</div>",this.get_ajax_icons(),a},get_ajax_icons:function(){var n=this;void 0===n.$instance_response?c.ajax({url:ak_framework_loc.ajax_url,type:"POST",dataType:"json",data:{action:"ak_admin_ajax",action_id:"ajax-icon-manager",nonce:ak_framework_loc.nonce},success:function(a){n.$instance_response=a,n.init_response(a)}}):setTimeout(function(){n.init_response(n.$instance_response)},300)},init_response:function(a){var e=this,i="";c.each(a.result,function(a,n){i=(i=(i+='<div  class="ak-icon-lists-header ak-clearfix">')+'<h3 class="header-title">'+n.name+"</h3>")+'</div><ul class="ak-icon-item-list ak-icon-item-list-'+a+' ak-clearfix">',c.each(n.icons,function(a,n){i=(i+='<li data-value="'+n.value+'" class="ak-icon-option ak-icon-select-button">')+'<a href="javascript:;" title="'+n.label+'">'+e.get_icon_tag(n.value)+"</a></li>",e.search_array.push({name:n.label})}),i+="</ul>"}),c(".ak-icon-load").html(i),e.icon_selector(),e.init_search()},init_search:function(){var t=this;c(".search-icons").on("keyup change",ak_debounce(function(a){var n,e=c(this).val(),i=".ak-icon-option";""!==e&&null!==e?0<(n=(e=new Fuse(t.search_array,{tokenize:!0,matchAllTokens:!0,threshold:.3,keys:["name"]}).search(e)).length)?(c(i).hide(),c(".icon-search-wrap").html(n+" Results Found"),c.each(e,function(a,n){c(i+'[data-value="'+n.name+'"]').show()})):(c(i).hide(),c(".icon-search-wrap").html("No Results")):(c(i).show(),c(".icon-search-wrap").html())},50))},icon_selector:function(){var e=this;""===e.but_el.find("input").val()?c(".ak-no-icon-button").hide():c(".ak-no-icon-button").show(),c(".ak-icon-select-button").on("click",function(a){a.preventDefault();a=c(this).data("value");e.setValue(a),swal({title:"",timer:1}),c(this).unbind("click")}),c(".ak-custom-icon-select").on("click",function(a){var n;a.preventDefault(),n?n.open():((n=wp.media.frames.file_frame=wp.media({title:ak_icon_manager_loc.custom_icon_select,button:{text:ak_icon_manager_loc.custom_icon_select},multiple:!1,library:{type:"image"}})).on("select",function(){var a=n.state().get("selection").first().toJSON();e.setValue(ak_sanitize_protocol(a.url)),swal({title:"",timer:1})}),n.open(),c(this).unbind("click"))})},get_icon_tag:function(a){return void 0!==a&&a?-1!==a.indexOf("fa-")?'<i class="ak-icon fa '+a+'"></i>':-1!==a.indexOf("akfi-")?'<i class="ak-icon '+a+'"></i>':-1!==a.indexOf("dashicons-")?'<i class="ak-icon dashicons '+a+'"></i>':-1!==a.indexOf("akai-")?'<i class="ak-icon '+a+'"></i>':'<i class="ak-icon ak-custom-icon ak-custom-icon-url"><img src="'+a+'"></i>':""}})}(jQuery);