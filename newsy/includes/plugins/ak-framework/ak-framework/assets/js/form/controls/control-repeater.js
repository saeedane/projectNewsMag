!function(l){"use strict";ak.form.controlConstructor.repeater=ak.form.controlConstructor.mix_fields.extend({ready:function(){this.initMixFields(),this.initRepeater()},initRepeater:function(){var i=this,t=i.container.find(".ak-repeater-field"),n=t.data("max"),a=t.find(".ak-repeater-group"),e=t.hasClass("ak-sorter-enabled");function r(){i.container.find(".ak-repeater-group-container").each(function(a,r){r=l(r);l(this).find(".ak-form-field-main-input").each(function(e,t){var n=l(this).parents(".ak-form-control").data("control-param-name");l(this).attr("name",i.id+"["+a+"]["+n+"]"),n===i.repeater_field_name&&r.find(".ak-repeater-row-name").text(l(this).val())})})}function o(e){var t=a.find(">*").last();t.removeClass("ak-close"),e&&t.find(".ak-form-control").Ak_Form_Control()}function f(){var e=a.find(">*");n<=e.length?alert("Max number of items added!"):(e=t.find("noscript").html().toString().replace(/%%v_key%%/g,e.length),a.append(e),o(!0))}this.repeater_field_name=t.data("repeat-title-field"),r(),o(!1),e&&a.sortable({items:".ak-repeater-group-container",handle:".ak-field-sorter-button,.ak-repeater-row-header-label",axis:"y",cancel:"",opacity:.7,tolerance:"pointer"}),this.onChange(function(){r()}),t.on("click",".ak-field-repeater-button",function(e){e.preventDefault(),f()}),t.on("click",".ak-repeater-row-header-label",function(e){e.preventDefault(),l(this).parent().parent().toggleClass("ak-close")}),t.on("click",".ak-field-remove-button",function(e){e.preventDefault(),l(this).parent().parent().parent().fadeOut(300,function(){l(this).remove()});e=a.find(">*");1===e.length&&(e.fadeOut("300"),setTimeout(function(){f()},300),e.fadeIn("300")),setTimeout(function(){r()},400)})}})}(jQuery);