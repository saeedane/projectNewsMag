!function(l){"use strict";ak.form.controlConstructor.select=ak.form.Control.extend({ready:function(){var n=this,e=n.container.find(".ak-form-field-main-input"),t=e.data("selectize"),a=e.data("options"),i=e.data("values"),d=e.data("exculable"),o=parseInt(e.data("multiple"));1<(o=!o||""===o||o<2?1:o)&&t?l(e).selectize({plugins:["remove_button","drag_drop"],maxItems:o,hideSelected:!0,valueField:"value",labelField:"text",render:{item:function(e,t){var n=e.text;return void 0===n?"<div><span>"+e.value+"</span></div>":"<div><span>"+n+"</span></div>"},option:function(e,t){var n=e.text;return void 0===n?"<div><span>"+e.value+"</span></div>":"<div><span>"+n+"</span></div>"}},onInitialize:function(){var n=this,e=(n.clearOptions(!0),"string"==typeof i?i.split(","):i);"object"!=typeof e&&(e=[e]),l.each(a,function(e,t){n.addOption({value:e,text:t})}),e.forEach(function(e){var t;d&&"-"===e.toString().substring(0,1)&&(t=e.toString().replace("-",""),n.removeOption(t,!0),n.addOption({value:"-"+t,text:a[t]})),n.addItem(e)})},onItemAdd:function(e,t){"-"===e.substring(0,1)&&t.addClass("excluded"),d&&(t.find(".exclude-btn").length<1&&t.append('<a href="javascript:void(0)" class="exclude-btn" tabindex="-1" title="Toggle Exclude"></a>'),n.exculade(t,this))},onChange:function(e){n.setting.set(e)}}):t?l(e).selectize({allowEmptyOption:!0,onChange:function(e){n.setting.set(e)}}):e.on("change",function(){n.setting.set(this.value)})},exculade:function(n,a){l(n).on("click",".exclude-btn",function(e){e.preventDefault();var e=l(n).data("value"),t=l(n).find("span").text();l(n).toggleClass("excluded"),l(n).hasClass("excluded")&&"-"!==e.toString().substring(0,1)?(a.removeOption(e,!0),a.removeItem(e,!0),a.addOption({value:"-"+e,text:t}),a.addItem("-"+e)):(e=e.toString().replace("-",""),a.removeOption("-"+e,!0),a.removeItem("-"+e,!0),a.addOption({value:e,text:t}),a.addItem(e))})},setValue:function(e){var n=this.container.find(".ak-form-field-main-input"),t=n.data("selectize"),a=parseInt(n.data("multiple"));1<(a=!a||""===a||a<2?1:a)&&t?(l(n)[0].selectize.clear(),!e&&""==e||l.each(e,function(e,t){l(n)[0].selectize.addItem(t)})):t?(l(n)[0].selectize.clear(),!e&&""==e||l(n)[0].selectize.setValue(e)):n.val(e),this.setting.set(e)}})}(jQuery);