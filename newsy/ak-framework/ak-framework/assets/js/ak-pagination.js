!function(s){"use strict";function n(a,i){if(this.element=s(a),!this.element.hasClass(i.loadedClass)&&(this.id=this.element.attr("id"),this.xhr=null,this.xhr_cache=[],this.current_id=this.id,this.current_page=1,this.is_masonary=this.element.hasClass("ak-masonry"),this.is_masonary&&(this.masonary_options={itemSelector:i.masonry_item_class,horizontalOrder:!0},s(i.pagination_wrap_class,a).masonry(this.masonary_options)),0!==s(i.pagination_wrap_class,a).length&&(this.block_data_var_prefix=i.block_data_var_prefix,this.pagination_wrap_class=i.pagination_wrap_class,this.pagination_btn_wrap_class=i.pagination_btn_wrap_class,this.pagination_btn_class=i.pagination_btn_class,this.tab_btn_class=i.tab_btn_class,this.is_rtl=i.is_rtl,this.ajax_url=i.ajax_url,this.ajax_action=i.ajax_action,this.loading_html=i.loading_html,this.block_data=this.get_ajax_data(this.block_data_var_prefix+this.id),this.block_data)))return this.block_pagination_type=this.block_data.atts.pagination,this.doing_type=this.block_data.atts.pagination,this.pagination_wrap=s(this.pagination_wrap_class,a),this.pagination_btn_wrap=s(this.pagination_btn_wrap_class,a),this._pagin_action=!1,this._pagin_but_el=s(this.pagination_btn_class,a),0!==this.element.find(this.pagination_btn_class).length&&this.handle_pagination(),0!==this.element.find(this.tab_btn_class).length&&this.handle_tabs(),this.element.addClass(i.loadedClass),this}n.prototype.handle_pagination=function(){var n=this;n.element.on("click",n.pagination_btn_class,function(a){a.preventDefault(),n.doing_type=n.block_data.atts.pagination;var a=s(this),i=a.data("action");if(a.hasClass("disabled")||a.hasClass("loading")||n.pagination_wrap.hasClass("ak-loading"))return!1;if("prev"===i){if(n.current_page<1)throw"Error!";n.current_page--}else n.current_page++;2===n.current_page&&"next_prev"===n.block_pagination_type&&n.add_first_view_cache(),n._pagin_but_el=a,n._pagin_action=i,n.ajax()}),"infinity"!==n.block_pagination_type&&"infinity_load_more"!==n.block_pagination_type||n.init_infinity_load()},n.prototype.handle_tabs=function(){var n=this;n.element.on("click",n.tab_btn_class,function(a){a.preventDefault();var a=s(this),i=a.data("tab-id");if(a.hasClass("active"))return!1;n.element.find(n.tab_btn_class).removeClass("active"),a.addClass("active"),n.add_first_view_cache(),n.current_id=i,n.current_page=1,n.doing_type="tab",n.ajax()})},n.prototype.add_first_view_cache=function(){var a=this;void 0===a.get_cache(a.id,1)&&a.add_cache(a.id,1,{html:a.pagination_wrap.html(),current_page:a.pagination_btn_wrap.find(".ak-pagination-label>span.current").html(),total_page:a.pagination_btn_wrap.find(".ak-pagination-label>span.total").html(),have_next:!0,have_prev:!1})},n.prototype.ajax=function(){var a,i=this,n=i.get_cache(i.current_id,i.current_page);"object"==typeof n?i.handle_response(n):("next_prev"===i.doing_type||"tab"===i.doing_type?i.start_wrapper_loading_html():i._pagin_but_el.addClass("loading"),n=s.extend({action:i.ajax_action,id:i.id,current_page:i.current_page},i.block_data),i.id!==i.current_id&&(a=i.element.find(".ak-tab-btn.active"),n=s.extend({doing_tab:1,tab_filter:a.data("filter"),tab_filter_value:a.data("filter-value")},n)),i.xhr=s.ajax({url:i.ajax_url,type:"POST",dataType:"json",data:n}).fail(function(a){i.finish_wrapper_loading_html(),i._pagin_but_el.removeClass("loading"),"abort"!==a.statusText&&console.log("Cannot load data.")}).done(function(a){i.handle_response(a),i.add_cache(i.current_id,i.current_page,a)}))},n.prototype.handle_response=function(a){var i=this;if(null==a||void 0===a.html)return i.pagination_wrap.html(""),void i.finish_wrapper_loading_html();0===a.total_page?i.pagination_btn_wrap.hide():i.pagination_btn_wrap.show();var n,t,e=s(a.html),_=!1;switch(i.doing_type){case"tab":i.pagination_wrap.html(e),i.finish_wrapper_loading_html(),i.is_masonary||i.pagination_wrap.addClass("ak-anim ak-anim-slide-in-down").delay(400).queue(function(a){s(this).removeClass("ak-anim ak-anim-slide-in-down"),a()});break;case"next_prev":i.pagination_wrap.html(e),i.finish_wrapper_loading_html(),i.is_masonary||i.pagination_wrap.addClass("ak-anim").addClass("prev"===i._pagin_action?"ak-anim-slide-in-left":"ak-anim-slide-in-right").delay(400).queue(function(a){s(this).removeClass("ak-anim ak-anim-slide-in-right ak-anim-slide-in-left"),a()});break;case"load_more":case"infinity":case"infinity_load_more":var o,_=!0;i._pagin_but_el.removeClass("loading"),i.is_masonary||(o=0,e.each(function(){s(this).hasClass("ak-module")?(s(this).addClass("ak-anim ak-anim-slide-in-down ak-anim-delay-"+o),o++):s(this).find(".ak-module").each(function(){s(this).addClass("ak-anim ak-anim-slide-in-down ak-anim-delay-"+o),o++})})),i.pagination_wrap.append(e)}switch(i.block_pagination_type){case"next_prev":i.pagination_btn_wrap.find(".ak-pagination-label>span.current").html(a.current_page),i.pagination_btn_wrap.find(".ak-pagination-label>span.total").html(a.total_page),i.pagination_btn_wrap.find(".next")[a.have_next?"removeClass":"addClass"]("disabled"),i.pagination_btn_wrap.find(".prev")[a.have_prev?"removeClass":"addClass"]("disabled");break;case"load_more":case"infinity":case"infinity_load_more":"infinity"===i.block_pagination_type||"infinity_load_more"===i.block_pagination_type?a.have_next?(i._pagin_but_el.removeClass("disabled"),n=!0,"infinity_load_more"===i.block_pagination_type&&(t=null==(t=i.block_data.atts.infinity_break_count)||""===t?3:parseInt(t),a.current_page>=t&&(i.pagination_btn_wrap.removeClass("infinity_load_more"),i.pagination_btn_wrap.addClass("load_more"),n=!1)),s(window).width()<768&&(i.pagination_btn_wrap.removeClass("infinity"),i.pagination_btn_wrap.removeClass("infinity_load_more"),i.pagination_btn_wrap.addClass("load_more"),n=!1),n&&i.init_infinity_load()):i._pagin_but_el.addClass("disabled"):a.have_next?i._pagin_but_el.removeClass("disabled"):(i._pagin_but_el.addClass("disabled"),i._pagin_but_el.find(".loaded").remove(),i._pagin_but_el.find(".no-more").show())}i.is_masonary&&i.pagination_wrap.masonry(_?"appended":"prepended",e).masonry("layout"),i.element.trigger("ak-pagination-after-response",[e])},n.prototype.init_infinity_load=function(){var i=this;setTimeout(function(){s(i.pagination_btn_wrap).waypoint(function(a){i.pagination_btn_wrap.find("a:not(.loading)").trigger("click"),this.destroy()},{offset:"bottom-in-view",context:window,once:!0})},1e3)},n.prototype.get_ajax_data=function(a){var i;return void 0!==window[a]?i=window[a]:console.log("error:"+a),i},n.prototype.start_wrapper_loading_html=function(){var a=this;a.pagination_wrap.addClass("ak-loading"),a.pagination_wrap.prepend('<div class="ak-loading-box">'+a.loading_html+"</div>")},n.prototype.finish_wrapper_loading_html=function(){this.pagination_wrap.removeClass("ak-loading"),this.pagination_wrap.find(".ak-loading-box").remove()},n.prototype.get_cache=function(a,i){var n=this;if(void 0!==n.xhr_cache[a]&&void 0!==n.xhr_cache[a][i])return n.xhr_cache[a][i]},n.prototype.add_cache=function(a,i,n){var t=this;void 0===t.xhr_cache[a]&&(t.xhr_cache[a]={}),t.xhr_cache[a][i]=n},s.fn.Ak_Pagination=function(a){var i={pagination_wrap_class:".ak-pagination-wrapper",pagination_btn_wrap_class:".ak-pagination",pagination_btn_class:".ak-pagination-btn",tab_btn_class:".ak-tab-btn",masonry_item_class:".ak-pagination-item",block_data_var_prefix:"ak_pagination_data_",loadedClass:"ak-pagination-loaded",is_rtl:!1,ajax_url:ak_ajax_url,ajax_action:"ajax_pagination",loading_html:'<div class="ak-loading-icon"><i class="fa-li fa fa-spinner fa-spin"></i></div>'};return a=a?s.extend(i,a):s.extend(i),s(this).each(function(){new n(this,a)})}}(jQuery);